\chapter{Scalar Field in Black Hole Anti de Sitter}
\label{ch:AdSBlackHole}

\section{Introduction}

In chapter \ref{ch:scalarfieldAdS} we learned how to deal with AdS space and in last section, section \ref{sec:SimpleAdSBlackHole}, we solved the scalar field equation for simple black hole in Anti de Sitter space and studied the behavior of waves near horizon and boundary of black hole. In this chapter we want to study black holes in AdS space more generally. For example in the following section we are going to derive the equations for charged black hole and then we are going to study the behavior of wave function, general solution of scalar field near horizon and boundary. Then we apply this idea to some real systems and try to study the behavior of some condens matter systems by applying this idea to our system.\\

\section{Charged Black Hole in AdS}

In section \ref{sec:SimpleAdSBlackHole} we saw that the metric for simle black hole has the form of,

\begin{equation}
    ds^2 = - \left( k^2r^2 + 1 - \frac{C}{r^{d-2}} \right)dt^2 + \frac{1}{k^2r^2 + 1 - \frac{C}{r^{d-2}}}dr^2 + r^2 d\Omega^2
\end{equation}

or,

\begin{equation}
    ds^2 = \frac{u^2}{L^2} \left[ -(1-(\frac{u_0}{u})^d) dt^2 + \sum\limits_{i=1}^{d-1} dx_i^2 \right] + \frac{L^2 du^2}{u^2 (1-(\frac{u_0}{u})^d)}
\end{equation}

Now we can add charge to our black hole and make it charged black hole. So the metric changes as,

\begin{equation} \label{eq:ChargedBlackHoleAdSMetric}
    ds^2 = \frac{r^2}{R^2}(-fdt^2 + d\vec{x}^2) + \frac{R^2}{r^2}\frac{dr^2}{f} \quad , \quad f = 1+\frac{Q^2}{r^{2d-2}}-\frac{M}{r^d}
\end{equation}

and we can find the radius of horizon,

\begin{equation} \label{eq:radiusHorizonChargedBlackHole}
    f(r_0) = 0 \rightarrow  M = r^d_0 + \frac{Q^2}{r^{d-2}_0}
\end{equation}

Also charge, energy, and entropy density have forms of,

\begin{equation}
    \rho = \frac{2(d-2)}{c_d}\frac{Q}{\kappa^2 R^{d-1}g_F} \quad , \quad \epsilon = \frac{d-1}{2\kappa^2}\frac{M}{R^{d+1}} \quad , \quad s = \frac{2\pi}{\kappa^2}(\frac{r_0}{R})^{d-1}
\end{equation} 

And temprature of this system is,

\begin{equation}
    T = \frac{dr_0}{4\pi r^2}(1-\frac{(d-2)Q^2}{dr_0^{2d-2}})
\end{equation}

For zero temprature, $r_0^{2d-2} = \frac{(d-2)Q^2}{d}$, the redshift factor $f$ gets the form of,

\begin{equation}
    f = 1- (\frac{r_0}{r})^d + \frac{d}{d-2}(\frac{r_0}{r})^d\bigg((\frac{r_0}{r})^{d-2} - 1\bigg)
\end{equation}

Near the horizon, $f \rightarrow 0$ or $r \rightarrow r_0$, we can write the taylor series, so we have,

\begin{equation}
    f = d(d-1)(\frac{r-r_0}{r_0})^2 + \cdots
\end{equation}

By changing the varibales, $r-r_0 = \frac{\lambda R^2_2}{\zeta}$ and $t = \lambda^{-1}\tau$, which $R^2_2 = \frac{R^2}{d(d-1)}$ we find that the metric becomes,

\begin{equation}
    ds^2 = \frac{R^2_2}{\zeta^2}(-d\tau^2 + d\zeta^2) + \frac{r^2_0}{R^2}d\vec{x}^2
\end{equation}

and for low temprature, by replacing $r_0 - r_* = \lambda \frac{R^2_2}{\zeta_0}$, the metric has the form of,

\begin{equation}
    ds^2 = \frac{R^2_2}{\zeta^2}\bigg(-(1-\frac{\zeta}{\zeta_0})d\tau^2 + \frac{d\zeta^2}{1-\frac{\zeta}{\zeta_0}} \bigg) + \frac{r^2_0}{R^2}d\vec{x}^2
\end{equation}

and the temprature is,

\begin{align}
    T &= \frac{dr_0}{4\pi R^2}\bigg(1-\frac{r_*^{2d-2}}{r_0^{2d-2}}\bigg) \\
      &= \frac{dr_0}{4\pi R^2}\frac{(r_0 - r_*)(r_0^{2d-1} + r_*r_0^{2d} + \cdots r_*^{2d}r_0 + r_*^{2d-1})}{r_0^{2d-2}} \nonumber\\
      &= \frac{dr_0}{4\pi R^2}\frac{2(d-1)(r_0 - r_*)r_0^{2d-1}}{r_0^{2d-2}} = \frac{1}{2\pi\zeta_0} \nonumber
\end{align}

For zero temrature and for charged balck hole in AdS space near the horizon the metric tensor has the form of,

\begin{equation} \label{eq:ChargedBlackHoleAdSZeroT_metrictensor}
    g_{\mu\nu} = 
    \begin{pmatrix}
        -\frac{R^2_2}{\zeta^2} & & 0 \\
        & \begin{pmatrix}
            \frac{r^2_0}{R^2} & 0 & \cdots & 0 \\
            0 & \frac{r^2_0}{R^2} & \cdots & 0 \\
            \vdots  & \vdots  & \ddots & \vdots  \\
            0 & 0 & \cdots & \frac{r^2_0}{R^2}
        \end{pmatrix}_{d-1 \times d-1}
        &\\
        0 & & \frac{R^2_2}{\zeta^2} 
    \end{pmatrix}
\end{equation}

and for low temprature has the form of,

\begin{equation} \label{eq:ChargedBlackHoleAdSLowT_metrictensor}
    g_{\mu\nu} = 
    \begin{pmatrix}
        -\frac{R^2_2}{\zeta^2}\big(1-\frac{\zeta^2}{\zeta^2_0}\big) & & 0 \\
        & \begin{pmatrix}
            \frac{r^2_0}{R^2} & 0 & \cdots & 0 \\
            0 & \frac{r^2_0}{R^2} & \cdots & 0 \\
            \vdots  & \vdots  & \ddots & \vdots  \\
            0 & 0 & \cdots & \frac{r^2_0}{R^2}
        \end{pmatrix}_{d-1 \times d-1}
        &\\
        0 & & \frac{R^2_2}{\zeta^2}\frac{1}{1-\frac{\zeta^2}{\zeta^2_0}} 
    \end{pmatrix}
\end{equation}

and equation of plain wave for zero and low temprature respectively would be,

\begin{equation}
    \frac{\zeta^2}{R^2_2}\frac{\partial^2 f(\zeta)}{\partial\zeta^2} + \left[\frac{\zeta^2k^2_t}{R^2_2} - m^2 - \frac{R^2k^2_{\vec{x}}}{r^2_0} \right] f(\zeta) = 0
\end{equation}

and,

\begin{equation}
    \frac{\zeta^2\big(1-\frac{\zeta^2}{\zeta^2_0}\big)}{R^2_2}\frac{\partial^2 f(\zeta)}{\partial\zeta^2} - 2\frac{\zeta^3}{R^2_2 \zeta^2_0}\frac{\partial f(\zeta)}{\partial\zeta} + \left[ \frac{\zeta^2k^2_t}{R^2_2(1-\frac{\zeta^2}{\zeta^2_0})} - m^2 - \frac{R^2k^2_{\vec{x}}}{r^2_0} \right] f(\zeta) = 0
\end{equation}

Now, let's focuse more on our original metric without doing any changing variables or taking any limits. By defining $f = 1+\frac{Q^2}{r^{2d-2}}-\frac{M}{r^d}$, the metric tensor of equation \ref{eq:ChargedBlackHoleAdSMetric} is,

\begin{equation} \label{eq:ChargedBlackHoleAdSLowT_metrictensor}
    g_{\mu\nu} = 
    \begin{pmatrix}
        -\frac{r^2}{R^2}f & & 0 \\
        & \begin{pmatrix}
            \frac{r^2}{R^2} & 0 & \cdots & 0 \\
            0 & \frac{r^2}{R^2} & \cdots & 0 \\
            \vdots  & \vdots  & \ddots & \vdots  \\
            0 & 0 & \cdots & \frac{r^2}{R^2}
        \end{pmatrix}_{d-1 \times d-1}
        &\\
        0 & & \frac{R^2}{r^2f} 
    \end{pmatrix}
\end{equation}

Now we are able to write the euqation of motion and solve it for scalar field, which describes the behaviour of plain wave in Anti de Sitter space with existance of a charged balck hole. Then we can study the behaviour of plain wave near the horizon and boundary and then we are able to find the Green function. So let's take a look at its differential equation,

\begin{align} \label{eq:equationofmotionchargeblackholeinads}
    0 =& \frac{1}{R^2}\left[(d+1)r - \frac{(d-3)Q^2}{r^{2d-3}} - \frac{M}{r^{d-1}} \right]\frac{\partial \phi(r)}{\partial r} \nonumber\\ 
      &+ \frac{r^2f}{R^2}\frac{\partial^2\phi(r)}{\partial r^2} + \left[ \frac{R^2}{r^2f}k^2_t-\frac{R^2}{r^2}k^2_{\vec{x}}-m^2\right]\phi(r)
\end{align} 

Now we are ready to study the behaviour of our wave function near horizon, $r \rightarrow r_0$, and near boundary, $r \rightarrow \infty$. For $d > 1$, near boundary redshift factor $f$ approaches to $1$ and the equation \ref{eq:equationofmotionchargeblackholeinads} would be simplified as,

\begin{equation} \label{eq:appsolutoinnearboundary}
    0 = r^2\frac{\partial^2\phi(r)}{\partial r^2} + (d+1)r\frac{\partial \phi(r)}{\partial r} - R^2m^2\phi(r)
\end{equation}

By substituting $\phi(r) = r^\alpha$ in our differential equation we get, $0 = \alpha^2 + \alpha d -R^2m^2$. So the answer near boundary is looks like,

\begin{equation} \label{eq:appsolutoinnearhorizon}
    \phi(r) = A(k_\mu)r^{\Delta-d} + B(k_\mu)r^{-\Delta} \quad , \quad \Delta = \frac{d}{2} + \sqrt{\frac{d^2}{4} + R^2m^2}
\end{equation}

Horizon dose not have a zero area so its radius is not zero, too. Equation \ref{eq:radiusHorizonChargedBlackHole} gives us the radius of horizon. Also instead of mass of black hole $M$ in redshift factor $f$ we can substitute $r^d_0 + \frac{Q^2}{r^{d-2}_0}$, so the redshift factor becomes,

\begin{align} \label{eq:redshiftfactorr0r*}
    f &= (1 - \frac{r^d_0}{r^d}) + \frac{Q^2}{r^d}\left[\frac{1}{r^{d-2}} - \frac{1}{r^{d-2}_0} \right] \\
      &= (r-r_0) \left[ \frac{r^{d-1} + r^{d-2}r_0 + \cdots + r^{d-2}_0r + r^{d-1}_0 }{r^d} \right. \nonumber\\
      & \qquad \qquad \qquad - \left. \frac{Q^2}{r^d}\frac{r^{d-3} + r^{d-4}r_0 + \cdots + r^{d-4}_0r + r^{d-3}_0}{r^{d-2}r^{d-2}_0} \right]
\end{align}

By defining $Q^2 \equiv \frac{d}{d-2}r^{2d-2}_*$, near horizon we can simplify our differential equation when $r \rightarrow r_0$, and $f \rightarrow (r-r_0)\left[\frac{d}{r_0} - \frac{dr^{2d-2}_*}{r^{2d-1}_0} \right]$,

\begin{equation}
    0 = \frac{\partial^2 \phi(r)}{\partial r^2} + \frac{1}{(r-r_0)}\frac{\partial \phi(r)}{\partial r} + \frac{1}{(r-r_0)^2} \times \frac{R^4k^2_t}{d^2r_0^2 \big(1-\frac{r^{2d-2}_*}{r^{2d-2}_0}\big)^2}\phi(r)
\end{equation}

or simply,

\begin{equation}
    0 = \frac{\partial^2 \phi(r)}{\partial r^2} + \frac{1}{(r-r_0)} \frac{\partial \phi(r)}{\partial r} + \frac{\beta^2}{(r-r_0)^2} \phi(r)
\end{equation}

when

\begin{equation}
    \beta^2 = \frac{R^4k^2_t}{d^2r_0^2\big(1-\frac{r^{2d-2}_*}{r^{2d-2}_0}\big)^2}
\end{equation}

And answer of this differential equation is:

\begin{equation} \label{eq:chargedblackholenearhorizonsolution}
    \phi(r) = A(r-r_0)^{ \sqrt{ - \beta^2}} + B(r-r_0)^{- \sqrt{-\beta^2}} = Ae^{ i\beta \ln{(r-r_0)}} + Be^{- i\beta\ln{(r-r_0)}} 
\end{equation}

\section{Zero Temperature}

The last equations are true when we are far from zero temprature. In this part, we are dealing with zero temperature, and then we will study these equations in low temprature, close to zero temprature. Equation \ref{eq:redshiftfactorr0r*} is the red shift factor, $f$, in finit temprature, but in zero temprature its form changes and, as we will see, we get factor of $(r-r_0)^2$. For simplicity, for our purpose we just focus on case $d = 4$, $3$ conventional space direction and one conventional time direction and an other spacelike direction for having $AdS_5/CFT_4$ theory. Zero temprature is when $r_0 = r_*$, so by substituting $Q = \frac{d}{d-2}r_0^{2d-2} $ for red shift factor one gets,

\begin{align} \label{eq:redshiftfactorr0r*zeroT}
    f &= \frac{(d-2)r^{2d-2} - (2d-2)r_0^{d}r^{d-2} + dr_0^{2d-2}}{(d-2)r^{2d-2}} \quad , \quad d = 4 \nonumber\\
      &= \frac{(r-r_0)^2(r+r_0)^2(r^2 + 2r_0^2)}{r^6}
\end{align}

And equation of motion for scalar field has the form of,

\begin{align} \label{eq:equationofmotionchargeblackholeinadsZetorT}
    0 =& \frac{1}{R^2}\left[\frac{(r-r_0)(r+r_0)(5r^4 + 5r_0^2r^2 + 2r_0^4)}{r^5}\right]\frac{\partial \phi(r)}{\partial r} \nonumber\\
      &+ \frac{r^2f}{R^2}\frac{\partial^2\phi(r)}{\partial r^2} + \left[ \frac{R^2}{r^2f}k^2_t-\frac{R^2}{r^2}k^2_{\vec{x}}-m^2\right]\phi(r)
\end{align} 

Note that in this case, zero temprature, $r_0$ is exactly equal to $r_*$. Now we want to find the Green function and behaviour of our function near boundart, $r \rightarrow \infty$ and close to horizon, $r \rightarrow r_0$. Near boundary nothing would change from before, everything we had in last section is true for zero temprature too and we have the same form of answer for zero tamprature. Because $Q$, charge of black hole wich is related to temprature, and $M$, mass of black hole which is related to radius of horizon, do not play any role in the equation of motion, equation \ref{eq:equationofmotionchargeblackholeinads}, near boundary, in case of $r \rightarrow \infty$. Close to horizon, $r \rightarrow r_0$, redshift factor has the form of $f = \frac{12}{r^2_0}(r-r_0)^2$, equation of motion \ref{eq:equationofmotionchargeblackholeinadsZetorT} gets the form of,

\begin{equation}
    0 = (r-r_0)^4\frac{\partial^2\phi(r)}{\partial r^2} + 2(r-r_0)^3\frac{\partial\phi(r)}{\partial r} + \frac{R^4k^2_t}{144}\phi(r)
\end{equation}

and the answer has the form of,

\begin{equation}
    \phi(r,\mu) = C(k_\mu) e^{\frac{i\beta}{r-r_0}} + D(k_\mu) e^{\frac{-i\beta}{r-r_0}} \quad , \quad \beta = \frac{R^2k_t}{12}
\end{equation}

$e^{\frac{i\beta}{r-r_0}}$ is incoming wave which is going through black hole and $e^{\frac{-i\beta}{r-r_0}}$ is out going wave which is going out of black hole. In our case, we are mostly interested in case that we have just incoming wave and there is no out going wave which go out of black hole. So one need to choos $B = 0$. Then we are able to find the Green's function,

\begin{equation}
   G(k_\mu) \equiv \frac{B(k_\mu)}{A(k_\mu)} \quad , \quad \phi(r,k_\mu) = A(k_\mu)r^{\Delta-d} + B(k_\mu)r^{-\Delta}  
\end{equation} 

\section{Charged Scalar Field in Charged Black Hole} \label{sec:ChargedScalarFieldinChargedBlackHole}

In this section we try to study behaviour of charged scalar field with charged black hole geometry in AdS space. Then we will learn more about the low friquencies, and then one should suggest low friquency limit to avoid breaking of the theory. Low friquency is breaking because of infinit number of degree of freedom. But let's first look at the action of charged scalar field

\begin{equation} \label{eq:ActionChargedScalarField} 
    S = - \int d^{d+1}x \sqrt{-|g|} \left[ (D_\mu\phi)^*(D^\mu\phi) + m^2\phi^*\phi \right] 
\end{equation}

where,

\begin{equation}
    D_\mu = \partial_\mu - iqA_\mu
\end{equation}

Note that action \ref{eq:ActionChargedScalarField} just depend on $q$ through:

\begin{equation}
    \mu_q \equiv \mu q 
\end{equation}

which is the effective chemical potential for the field of charge $q$. We are interested to work on frequency space so we should take fourier trasformation of $\phi(r,x^\mu)$ and writting,

\begin{equation}
    \phi(r,x^\mu) = \int \frac{d^dk}{\sqrt{(2\pi)^d}} \phi(r,k_\mu) e^{ik_\mu x^\mu} 
\end{equation}

And from now we work only on frequency space. After taking fourier trasformation we have,

\begin{equation}
    \frac{-1}{\sqrt{-|g|}} \partial_r (\sqrt{-|g|} g^{rr} \partial_r\phi) + \left[ g^{ii} (k^2 - u^2) + m^2 \right]\phi \quad ,
\end{equation}

where,

\begin{equation}
    u(r) = \sqrt{\frac{-g_{ii}}{g_{tt}}}\bigg(\omega + \mu_q(1-\frac{r_0^{d-2}}{r^{d-2}})\bigg) \quad ,
\end{equation}

If the action is defined by equation \ref{eq:ActionChargedScalarField}. By considering all above equations then for motion equation we get,

\begin{align} \label{eq:equationofmotionchargeblackholeinadsinchargescalarfield}
    0 =& \frac{r^2f}{R^2}\frac{\partial^2\phi(r)}{\partial r^2} + \frac{1}{R^2}\left[(d+1)r - \frac{(d-3)Q^2}{r^{2d-3}} - \frac{M}{r^{d-1}} \right]\frac{\partial \phi(r)}{\partial r} \nonumber\\ 
      & + \left[ \frac{R^2}{r^2f}\bigg(k_t + \mu_q(1-\frac{r_0^{d-2}}{r^{d-2}})\bigg)^2-\frac{R^2}{r^2}k_{\vec{x}}-m^2\right]\phi(r) 
\end{align}

Now we are ready to study $\phi(r,k_\mu)$ in finit temprature near boundary and close to horizon. As we have seen the radius of horizon is $r_0$ and boundary is located at $r \rightarrow \infty$. What ever we had on the last sections is true here. And nothing would be changed in our equation near boundary and close to horizon. By analyzing equation of \ref{eq:equationofmotionchargeblackholeinadsinchargescalarfield} we will get the following answers near boundary and close to horizon respectively,

\begin{equation}
    \phi(r,k_\mu) = A(k_\mu)r^{\Delta-d} + B(k_\mu)r^{-\Delta} \quad , \quad for \quad r \rightarrow \infty
\end{equation}

where $\Delta = \frac{d}{2} + \sqrt{\frac{d^2}{4} + m^2R^2}$ and,

\begin{equation}
    \phi(r) = C(k_\mu)e^{ i\beta \ln{(r-r_0)}} + D(k_\mu)e^{- i\beta\ln{(r-r_0)}} 
\end{equation}

where $\beta = \frac{R^2k_t}{d\big(1-\frac{r^{2d-2}_*}{r^{2d-2}_0}\big)}$. In the above equation, as we have seen before, $e^{-i\beta \ln{(r-r_0)}}$ and $e^{i\beta \ln{(r-r_0)}}$ are incoming wave, which goes into the black hole, and out going wave, which is going out of black hole. And finaly Green's function is defined,

\begin{equation}
   G(k_\mu) \equiv \frac{B(k_\mu)}{A(k_\mu)}  
\end{equation} 

Let's be more accurate close to the boundary and horizon. We want to expand the equations near boundary and horizon and find more terms to make our theory more accurate. Let's do it first for boundary. But becasue we are intrested in cases which $d =4$, $4$-dimentional cases, so here we do not solve the problem for general $d$-dimentional case. We can rewrite redshift factor, 

\begin{align}
    f(r) =& \frac{r-r_0}{r^6r_0^2} \left[ (4r_0^7-4r_*^6r_0) + (14r_0^6-2r_*^6)(r-r_0) + 20r_0^5(r-r_0)^2 \right. \nonumber\\
          &  \left. + 15r_0^4(r-r_0)^3 + 6r_0^3(r-r_0)^4 + r_0^2(r-r_0)^5 \right]
\end{align}

and the coefficient of $\frac{\partial\phi}{\partial r}$, let's call it $g(r)$, is

\begin{align}
    g(r) =& \frac{1}{r^5r_0^2} \left[ (4r_0^8-4r_0^2r_*^6) + (28r_0^7-4r_0r_*^6)(r-r_0) + (74r_0^6-2r_*^6)(r-r_0)^2 \right. \nonumber\\
          &  \left. + 100r_0^5(r-r_0)^3 + 75r_0^4(r-r_0)^4 + 30r_0^3(r-r_0)^5 + 5r_0^2(r-r_0)^6 \right]
\end{align}

In all of our equation $\phi$ is a function of $r$, $k_{\vec{x}}$, and $k_t=\omega$ and for simplicity we just write $\phi(r)$. But we are aware that actualy it is function of all of these terms through frourier trasformation. So now we are able to rewrite the equation of motion in $(r-r_0)^n$ terms, when $r \rightarrow r_0$,

\begin{align}
    0 =& \frac{(r-r_0)^2}{R^2r_0^{14}}\left[16(r_0^7-r_*^6r_0)^2 + 16(r_0^7-r_*^6r_0)(14r_0^6-2r_*^6)(r-r_0) \right. \nonumber\\
       & \qquad \qquad \qquad  \left. + (14r_0^6-2r_*^6)^2(r-r_0)^2 + \cdots \right] \frac{\partial^2\phi(r)}{\partial r^2} \nonumber\\
       & + \frac{(r-r_0)}{R^2r_0^{14}}\left[16(r_0^7-r_*^6r_0)^2 + 12(r_0^7-r_*^6r_0)(14r_0^6-2r_*^6)(r-r_0) \right. \\
       & \qquad \qquad \qquad \left. + 2(14r_0^6-2r_*^6)^2(r-r_0)^2 + \cdots \right] \frac{\partial\phi(r)}{\partial r} \nonumber\\
       & + \left[ \frac{R^2}{r_0^2}\left(\omega^2+2\omega\mu_q\frac{2}{r_0}(r-r_0)+ \mu_q^2\frac{4}{r_0^2}(r-r_0)^2 +\cdots\right) \right. \nonumber\\
       & \qquad \left. - \frac{r-r_0}{r_0^8} \left[(4r_0^7-4r_*^6r_0) + (14r_0^6-2r_*^6)(r-r_0) + \cdots \right] \left( \frac{R^2}{r_0^2}k_{\vec{x}}^2 + m^2 \right) \right] \phi(r) \nonumber
\end{align}

The solution has the form of,

\begin{align}
    \phi(r) =& A(k_\mu,\omega)\left[e^{-i\beta\ln{(r-r_0)}}+a_1e^{-i\beta\ln{(r-r_0)}}(r-r_0)+ a_2e^{-i\beta\ln{(r-r_0)}}(r-r_0)^2\right] \nonumber\\
            & \qquad + B(k_\mu,\omega)\left[e^{i\beta\ln{(r-r_0)}}+a_1e^{i\beta\ln{(r-r_0)}}(r-r_0)+ a_2e^{i\beta\ln{(r-r_0)}}(r-r_0)^2\right]
\end{align}

if $\tilde{M} = \frac{R^4}{r_0^2}k_{\vec{x}}^2+R^2m^2$, $\tilde{r}=\frac{r_*}{r_0}$, and $n = \mp i\beta$ then,

\begin{align}
    a_1 =& -\frac{8(7-\tilde{r}^6)(n^2-n)+6(7-\tilde{r}^6)n+\frac{\omega\mu_qR^4}{r_0^2(1-\tilde{r}^6)}-\tilde{M}}{16(n^2+n)+16(n+1)+\frac{R^4\omega^2}{r_0^2(1-\tilde{r}^6)}} \times \frac{4}{r_0} \nonumber\\    
    a_2 =& -\left[4(7-\tilde{r}^6)^2(n^2-n) + 8(7-\tilde{r}^6)^2n + 4\frac{R^4\mu_q^2}{r_0^2} - 2(7-\tilde{r}^6)\tilde{M} \right.\nonumber\\
         & \qquad \left. + 4r_0a_1\left((1-\tilde{r}^6)(7-\tilde{r}^6)(8n^2+14n+6) + \omega\mu_q\frac{R^4}{r_0^2} - (1-\tilde{r}^6)\tilde{M} \right) \right] \nonumber\\
         & \times \left[ 16r_0^2(1-\tilde{r}^6)^2(n^2 + 4n + 4) + \omega^2R^4 \right]^{-1} 
\end{align}

We can continue whay we have done above to find the higher order temrs of $\phi(r)$ near horizon. For our perpose these terms are more than enough. For the next step we are interested to calculate more terms near boundary. So let's look at equation of motion one more time when we are in $n$-dimentional space,

\begin{align}
    0 =& \left[r^4 - \frac{2M}{r^{d-4}} + \frac{(d-3)2Q^2}{r^{2d-6}} + \frac{M^2}{r^{2d-4}} - \frac{Q^2M}{r^{3d-6}} + \frac{(d-3)Q^4}{r^{4d-8}}\right] \frac{\partial^2\phi(r)}{\partial r^2} \nonumber\\
       & \left[(d+1)r^3 - \frac{(d+2)M}{r^{d-3}} + \frac{4Q^2}{r^{2d-5}} + \frac{(d-4)MQ^2}{r^{3d-3}} + \frac{M^2}{r^{2d-3}} - \frac{(d-3)Q^4}{r^{3d-5}} \right] \frac{\partial\phi(r)}{\partial r} \nonumber\\
       & \left[\left(R^4 \left(k_t +\mu_q(1-\frac{r_0^{d-2}}{r^{d-2}})\right)^2 - R^4k_{\vec{x}}^2\right)-R^2m^2\left(r^2 + \frac{Q^2}{r^{2d}} - \frac{M}{r^{d-2}}\right)\right] \phi(r)
\end{align}

For case $d =4$ answer has the form of, 

\begin{align}
    \phi(r) =& A(k_\mu,\omega)r^{\Delta-4}\left[1 + a_1\frac{1}{r^2} + a_2\frac{1}{r^4} + \cdots\right]\nonumber\\
             & B(k_\mu,\omega)r^{-\Delta} \left[1 + a'_1\frac{1}{r^2}+ a'_2\frac{1}{r^4}+ \cdots\right]
\end{align}

where, $n =\Delta-d$ and $-\Delta$ respectivly for $a_1$, $a_2$ and $a'_1$, $a'_2$.

\begin{align}
    a_1 , a'_1 =& -\frac{R^4(k_t+\mu_q)^2 - R^4k^2_{\vec{x}}}{n^2-4- R^2m^2}\nonumber\\
    a_2 , a'_2 =&  \frac{2M(n^2+2n)-a_2\left(R^4(k_t+\mu_q)^2 - R^4k^2_{\vec{x}}\right) + MR^2m^2}{n^2-4n - R^2m^2}
\end{align}


\subsection{Exeptional Cases}
In this part we talk about some exeptional cases, for example when $\Delta-d=-\Delta$ then our both independent answer become dependent and they are not different solutions of our differential equation. And we know that for second order differential equation we have to get two independent solution.\\

So for case $\Delta-d=-\Delta$, or in other word $\Delta = \frac{d}{2}$ or $-\frac{d^2}{4} = R^2m^2$, our solution bear boundary has the form of, 

\begin{equation}
   \phi(r) = A(k_{\mu},\omega)r^{-\Delta} + B(k_{\mu},\omega)r^{-\Delta}~\ln{(r)}
\end{equation}

and for more general cases, when we are looking for more terms near boundary and $\Delta=k$ and $k$ in an integer number and $d = 4$, answer has the form of,

\begin{align} \label{eq:generalanswerexeptionalcases2}
   \phi(r) =&~A_1(k_{\mu},\omega)r^{n} + r^{n-2}\left[A_{21}(k_{\mu},\omega) + A_{22}(k_{\mu},\omega)~\ln{(r)}\right] \nonumber\\
    &+ r^{n-4}\left[A_{31}(k_{\mu},\omega) + A_{32}(k_{\mu},\omega)~\ln{(r)} + A_{33}(k_{\mu},\omega)~\ln^2{(r)}\right] \nonumber\\
    &+ \cdots 
\end{align}

wehre $n = max(-\Delta,\Delta-4)$.\\

In equation \ref{eq:generalanswerexeptionalcases2} there are just two independent coefficent, lets say $A_1$ and $A_{21}$, and the other are dependent to these two coefficient. For the first dependent coefficient we get,

\begin{equation}
   A_{22}(k_{\mu},\omega) = \frac{R^4(k^2_{\vec{x}} - k^2_t)}{2n} \quad , \quad n = max(-\Delta,\Delta-4)
\end{equation}

\section{Numerical Approach}

Equation of motion of form \ref{eq:equationofmotionchargeblackholeinadsinchargescalarfield} is hard, or in other word is impossible, to solve analyticaly so far, cunsequently for studying the features of Green function one needs to solve the motion equation by numerical methods. In this section, we try to introduce an appropriate numerical method for solving this equation and then we use that method for studying the Green function under different conditions. Our aim is developing a numerical method which use near horizon condition to calculate the Green function.\\

One of the best numerical method with hight accuracy is Runge-Kutta method. For the first time, this technique were developed and used by the German mathematicians C. Runge and M.W. Kutta. Let's define our initial value problem as following,

\begin{equation}
    \phi(k_\mu,\omega,r_i) = \phi_i \quad , \quad \frac{\partial \phi(k_\mu,\omega,r_i)}{\partial r} = \dot{\phi}_i
\end{equation}

For initial condition we want to start from horizon, or it is better to say near horizon, and calculate the Green funtion. In section \ref{sec:ChargedScalarFieldinChargedBlackHole} we learned that the solution near horizon has the form of,

\begin{align}
    \phi(k_\mu,\omega,r) =& A(k_\mu,\omega)e^{-i\beta\ln{(r-r_0)}}\left[1+a_1(r-r_0)+ a_2(r-r_0)^2 + \cdots \right] \nonumber\\
             & + B(k_\mu,\omega)e^{i\beta\ln{(r-r_0)}}\left[1+a_1(r-r_0)+ a_2(r-r_0)^2 + \cdots \right]
\end{align}

Exactly in $r=r_0$ the fuction is not difined so one should start somewhere close to $r_0$. We will start from point $r = r_0 + h$, lets call it start point, as our initial condition. So for initial condition we have, 

\begin{align}
    \phi_i(k_\mu,\omega,r_0 + h) =& A(k_\mu,\omega)e^{-i\beta\ln{(h)}}\left[1+a_1(h)+ a_2(h)^2 + \cdots \right] \nonumber\\
             & + B(k_\mu,\omega)e^{i\beta\ln{(h)}}\left[1+a_1(h)+ a_2(h)^2 + \cdots \right] \nonumber\\
    \dot{\phi}_i(k_\mu,\omega,r_0 + h) =& -i\beta A(k_\mu,\omega)\frac{e^{-i\beta\ln{(h)}}}{h}\left[1+a_1(h)+ a_2(h)^2 + \cdots \right] \nonumber\\
             & + i\beta B(k_\mu,\omega)\frac{e^{i\beta\ln{(h)}}}{h}\left[1+a_1(h)+ a_2(h)^2 + \cdots \right] \nonumber\\
             & + A(k_\mu,\omega)e^{-i\beta\ln{(h)}}\left[a_1+ 2a_2(h) + \cdots \right] \nonumber\\
             & + B(k_\mu,\omega)e^{i\beta\ln{(h)}}\left[a_1+ 2a_2(h) + \cdots \right]
\end{align}

We will use Runge-Kutta scheme to find the value of $\phi(k_\mu,\omega,r)$ in each point. We will start from start point and continue going forward in $r$ direction untile we get to the aim point, let's say $r_f$. In each step we use forth order Runge-Kutta scheme to find the next point. If we have the derivative of $n^{th}$ point then we are able to use the following formula to calculate the $(n+1)^{th}$ point,

\begin{align}
    \phi_{n+1}       &= \phi_n  + \frac{k_1+2k_2+2k_3+k_4}{6} \nonumber\\
    \dot{\phi}_{n+1} &= \dot{\phi}_n + \frac{l_1+2l_2+2l_3+l_4}{6}
\end{align}

where,

\begin{align}
    RH_{cons}(r,\phi,\dot{\phi}) &= \frac{\partial^2\phi}{\partial r^2} \nonumber\\
              &= - \frac{1}{f}\left[\frac{d+1}{r}-\frac{(d-3)Q^2}{r^{2d-1}}-\frac{M}{r^{d+1}}\right]\dot{\phi} \nonumber\\ 
              & - \left[\frac{R^4}{r^4f^2}\left(k_t + \mu_q(1-\frac{r_0^{d-2}}{r^{d-2}})\right)^2-\frac{R^4}{r^4f}k_{\vec{x}}-\frac{R^2m^2}{r^2f}\right]\phi \nonumber\\
    l_1 &= h~RH_{cons}(r_n,\phi_n,\dot{\phi}_n) \nonumber\\
    k_1 &= h~\dot{\phi_n} \nonumber\\
    l_2 &= h~RH_{cons}( r_n+0.5h , \phi_n+0.5k_1 , \dot{\phi}_n+0.5l_1) \nonumber\\
    k_2 &= h~(\dot{\phi}_n+0.5l_1) \nonumber\\
    l_3 &= h~RH_{cons}( r_n+0.5h , \phi_n+0.5k_2 , \dot{\phi}_n+0.5l_2) \nonumber\\
    k_3 &= h~(\dot{\phi}_n+0.5l_2) \nonumber\\
    l_4 &= h~RH_{cons}( r_n+h , \phi_n+k_3 , \dot{\phi}+l_3) \nonumber\\ 
    k_4 &= h~(\dot{\phi}+0.5l_3) \nonumber\\
\end{align}

This method is $4^{th}$ order Runge-Kutta method, say RK4, and its error is $\frac{1}{120}h^5\phi^{5}(\xi)$ which $\xi$ is between $r_n$ and $r_{n+1}$, and $\phi^{5}(\xi)$ is $5^{th}$ derivative of function $\phi$.

\subsection{Adaptive grid size}

In Runge-Kutta scheme it is easy to change the grid size in each step of solution. In each step we can use a independent grid size of $h$, which means that this grid size do not depent on its last grid size and its following grid size. In prolem like this which in some rigions like near horizon the equations has flactuating features for not loosing the details and get the approprate solutions, one need to have a small grid size and close to boundary which it is a smooth function without any flactuating behaviour small grid size slow down the computational process and make the code time expensive. So one need to find a way to deal with the grid size regard to feature of our function, make the grid size small when we have a fluctuations and/or make the grid size when we have a smooth function. We can change our varibale to new ones to make our function smooth in all regions to use the same grid size. Always this method is not working because it is hard to find an appropriate coordinates to change our function to a simple smooth function. The best way is that introduce a way to deal with grid size directly. In each step it would be good to find an appropriate grid size independently and apply that grid size for that specific step. And we do the same process for each step, then we can controle the error of our answer by changing the grid size into appropriate one.\\

First of all, we are looking at the error of each step. As we may know the error of $4^{th}$ order Runge-Kutta is,

\begin{equation} \label{eq:RK4err}
    err = \frac{1}{120}h^5\phi^{5}(\xi) \quad , \quad \phi^{5}(\xi) = \frac{\partial^5\phi(\xi)}{\partial \xi^5} \quad , \quad  r_i \leq \xi \leq r_i+h
\end{equation}

so we can consider specific error for each step and then we are able to calculate step size. The problem is that we don't know exactly the value of $\phi^{5}(\xi)$. In maximume $\phi^{5}(\xi)$ is the maximum of $5^{th}$ derivative of $\phi(\xi)$ between $r_{i}$ and $r_{i+1}$, but even we don't know the maximume value of $\phi^{5}(\xi)$. So we need to define another constrain for $h$. We know that for this specific differential equations the solution near horizon is flactuating so rapidly but as it going forward to infinity it gets smoother, by smoother we mean that its higher derivative gets smaller and smaller. So approximatly it is possible to find the maximume of $5^{th}$ derivative by finding the $5^{th}$ derivative of approximate solution near horizon. By useing equation \ref{eq:appsolutoinnearhorizon} and considering incomeing wave for $5^{th}$ derivative we gets,

\begin{equation} \label{eq:nearhorizon5thdervitaive}
    \phi^{5}(r) = \frac{\partial^5\phi(r)}{\partial r^5} = \frac{(10\beta^2+5\beta^4) + (24\beta+\beta^5)i}{(r-r_0)^5}~e^{-i\beta~ln(r-r_0)}
\end{equation}

If we start our solution from $r_0+h_1$ then from equation \label{eq:nearhorizon5thdervitaive} it would be obvious that maximume of $5^{th}$ derivative is $\sqrt{(10\beta^2+5\beta^4)^2 + (24\beta+\beta^5)^2}~h_1^{-5}$. We can use this fomula and equation \ref{eq:RK4err} to calculate the step size $h_*$ near horizon. So for $h$ we get:

\begin{equation}
    h_* = h_1~\left[\frac{120~err}{\sqrt{(10\beta^2+5\beta^4)^2 + (24\beta+\beta^5)^2}}\right]^{1/5}
\end{equation}

and for all of our domain we can calculate the grid size $h$,

\begin{equation}
    h = min(h_* , \left[\frac{120~err}{\sqrt{(10\beta^2+5\beta^4)^2 + (24\beta+\beta^5)^2}}\right]^{1/5} , 1.0)
\end{equation}
